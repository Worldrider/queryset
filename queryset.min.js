/**
 * --------------------------------------------------------------------------
 * QuerySet (v1.0.0): queryset.js
 * Licensed under MIT (https://github.com/Worldrider/queryset/blob/master/LICENSE.txt)
 * --------------------------------------------------------------------------
 */
"use strict";class QuerySet extends Array{constructor(){let r=[];if(1==arguments.length&&Array.isArray(arguments[0]))for(var e=0;e<arguments[0].length;e++)r.push(arguments[0][e]);else r=Array.from(arguments);super(...r),this.setConfig()}setConfig(r){this.separator=r&&r.separator?r.separator:"__",window.moment&&(this.date_formats=r&&r.date_formats?r.date_formats:["DD/MM/YYYY","DD-MM-YYYY","DD.MM.YYYY","DD/MM/YYYY HH:mm","DD-MM-YYYY HH:mm","DD.MM.YYYY HH:mm","YYYY-MM-DDThh:mm:ss","YYYY/MM/DD","YYYY-MM-DD","YYYY.MM.DD","YYYY/MM/DD HH:mm","YYYY-MM-DD HH:mm","YYYY.MM.DD HH:mm"])}get(r){if(!r)return null;if(!Number.isInteger(r)&&r.constructor!==String)return this.filter(r).first();for(var e=0;e<this.length;e++)if(QuerySet.get_pk(this[e])==parseInt(r))return this[e];return null}update(r){if(QuerySet.get_pk(r))for(var e=0;e<this.length;e++)for(var t in r)r.hasOwnProperty(t)&&(this[e][t]=r[t])}getFilter(r,e,t,n,i){function s(r){if(null==r)return!0;if(Array.isArray(r)&&0==r.length)return!0;if(r.constructor===Object){for(var e in r)if(r.hasOwnProperty(e))return!1;return JSON.stringify(r)===JSON.stringify({})}return!1}function u(r,e,t){for(var n=0;n<e.length;n++){var l=e[n];if(!r.hasOwnProperty(l)&&("id"!=l&&"pk"!=l||!QuerySet.get_pk(r))){if("isnull"==e[e.length-1]){if(1==t)return!0;if(0==t)return!1}if(n==e.length-1){if("not"==l){if(null==t)return!s(r);if(r!=t)return!0}else if("isnull"==l){if(1==t)return s(r);if(0==t)return!s(r)}else if("icontains"==l){if(null!=r&&r.constructor===String&&null!=t&&t.constructor===String&&-1!==r.trim().toLowerCase().indexOf(t.trim().toLowerCase()))return!0}else if("iexact"==l){if(null!=r&&r.constructor===String&&null!=t&&t.constructor===String&&r.trim()==t.trim())return!0}else if("in"==l){if(null!=t&&Array.isArray(t))for(var f=0;f<t.length;f++)if(r==t[f])return!0}else if("not_in"==l){if(null!=t&&Array.isArray(t)){for(f=0;f<t.length;f++)if(r==t[f])return!1;return!0}}else if("lt"==l){if(null!=t){var a=QuerySet.parseDate(r,i),h=QuerySet.parseDate(t,i);if(a&&h){if(a<h)return!0}else if(r<t)return!0}}else if("lte"==l){if(null!=t){a=QuerySet.parseDate(r,i),h=QuerySet.parseDate(t,i);if(a&&h){if(a<=h)return!0}else if(r<=t)return!0}}else if("gt"==l){if(null!=t){a=QuerySet.parseDate(r,i),h=QuerySet.parseDate(t,i);if(a&&h){if(a>h)return!0}else if(r>t)return!0}}else if("gte"==l){if(null!=t){a=QuerySet.parseDate(r,i),h=QuerySet.parseDate(t,i);if(a&&h){if(a>=h)return!0}else if(r>=t)return!0}}else if(null==t)return!0}else if("not"!=e[e.length-1]&&null==t)return!0;return!1}if(r="id"==l||"pk"==l?QuerySet.get_pk(r):r[l],Array.isArray(r)){if(e.length-1==n+1&&"isnull"==e[n+1]){if(1==t)return s(r);if(0==t)return!s(r)}if(n==e.length-1&&null==t)return s(r);for(var o=e.slice(n+1),g=0;g<r.length;g++)return u(r[g],o,t)}else{if(e.length-1==n+1&&"isnull"==e[n+1]){if(1==t)return s(r);if(0==t)return!s(r)}if(n==e.length-1&&r==t)return!0}}return!1}for(var l in e){if(u(r,l.split(n),e[l])){if(!t)return!1}else if(t)return!1}return!0}filter(){if(1==arguments.length&&arguments[0]instanceof Function)return super.filter(arguments[0]);for(var r=[],e=0;e<arguments.length;e++)r.push(arguments[e]);if(!r.length)return new QuerySet(this);Array.isArray(r)||(r=[r]);var t=this.separator,n=this.date_formats,i=this.getFilter;return this.filter(function(e){for(var s=0;s<r.length;s++)if(i(e,r[s],!0,t,n))return!0;return!1})}exclude(){for(var r=[],e=0;e<arguments.length;e++)r.push(arguments[e]);if(!r.length)return new QuerySet(this);Array.isArray(r)||(r=[r]);var t=this.separator,n=this.date_formats,i=this.getFilter;return new QuerySet(this.filter(function(e){for(var s=0;s<r.length;s++)if(i(e,r[s],!1,t,n))return!0;return!1}))}remove(r){if(!r)return null;if(Number.isInteger(r)||r.constructor===String){for(var e=0;e<this.length;e++)if(QuerySet.get_pk(this[e])==parseInt(r))return this.splice(e,1),null}else{var t=this.filter(r);for(e=0;e<t.length;e++)this.pop(QuerySet.get_pk(to_delete[e]))}return null}values_list(r){if(!this.length)return[];var e=this.separator,t=r.split(e),n=[];function i(r,e,t){for(var n=0;n<e.length&&(r.hasOwnProperty(e[n])||("id"==e[n]||"pk"==e[n])&&QuerySet.get_pk(r));n++)if(r="id"!=e[n]&&"pk"!=e[n]||!QuerySet.get_pk(r)?r[e[n]]:QuerySet.get_pk(r),Array.isArray(r))if(n==e.length-1)for(var s=0;s<r.length;s++)t.push(r[s]);else{var u=e.slice(n+1);for(s=0;s<r.length;s++)i(r[s],u,t)}else t.push(r)}for(var s=0;s<this.length;s++)i(this[s],t,n);return new QuerySet(n)}sum(r){return this.length?this.values_list(r).reduce((r,e)=>r+e):0}avg(r){return this.length?this.sum(field)/this.length:0}order_by(){for(var r=[],e=0;e<arguments.length;e++)r.push(arguments[e]);var t=this.separator,n=this.date_formats;function i(r,e){for(var t=0;t<e.length&&(r.hasOwnProperty(e[t])||("id"==e[t]||"pk"==e[t])&&QuerySet.get_pk(r));t++)if("id"!=e[t]&&"pk"!=e[t]||!QuerySet.get_pk(r)){if(Array.isArray(r[e[t]]))return r;r=r[e[t]]}else r=QuerySet.get_pk(r);return r}for(e=0;e<r.length;e++){var s=r[e],u="-"==s[0];this.sort(function(r,e){if(u){var l=i(e,o=s.substr(1).split(t)),f=i(r,o);if("boolean"==typeof l&&"boolean"==typeof f)return l===f?0:l?-1:1;var a=QuerySet.parseDate(l,n),h=QuerySet.parseDate(f,n);return a&&h?a===h?0:a>h?1:-1:l===f?0:l>f?1:-1}var o;l=i(e,o=s.split(t)),f=i(r,o);if("boolean"==typeof l&&"boolean"==typeof f)return l===f?0:f?-1:1;a=QuerySet.parseDate(l,n),h=QuerySet.parseDate(f,n);return a&&h?a===h?0:a<h?1:-1:l===f?0:l<f?1:-1})}return this}add(r){this.push(r)}append(r){this.push(r)}extend(r){for(var e=0;e<r.length;e++)this.push(r[e])}delete(){for(;this.length;)this.pop()}first(){return this.length>0?this[0]:null}last(){return this.length>0?this[this.length-1]:null}exists(){return this.length>1}count(){return this.length}static parseDate(r,e){if(!window.moment)return r;if(r.constructor==Date)return r;if(r.constructor==String)for(var t=0;t<e.length;t++){var n=moment(r,e[t]);if(n.isValid()&&n.format(e[t])==r)return n.toDate()}return null}static get_pk(r){return r?r.id?parseInt(r.id):r.pk?parseInt(r.pk):null:null}toArray(){return new Array(this)}}
